from numpy import einsum
from numpy.typing import NDArray
from chem.hf.intermediates_builders import Intermediates
from chem.ccsd.uhf_ccsd import UHF_CCSD_Data


def get_lambda_singles_res_aa(
    uhf_scf_data: Intermediates,
    uhf_ccsd_data: UHF_CCSD_Data,
) -> NDArray:
    f_aa = uhf_scf_data.f_aa
    f_bb = uhf_scf_data.f_bb
    g_aaaa = uhf_scf_data.g_aaaa
    g_abab = uhf_scf_data.g_abab
    g_bbbb = uhf_scf_data.g_bbbb
    va = uhf_scf_data.va
    vb = uhf_scf_data.vb
    oa = uhf_scf_data.oa
    ob = uhf_scf_data.ob
    t1_aa = uhf_ccsd_data.t1_aa
    t1_bb = uhf_ccsd_data.t1_bb
    t2_aaaa = uhf_ccsd_data.t2_aaaa
    t2_abab = uhf_ccsd_data.t2_abab
    t2_bbbb = uhf_ccsd_data.t2_bbbb
    if uhf_ccsd_data.lmbda is None:
        raise RuntimeError("Lambda amplitues missing in UHF_CCSD_Data")
    l1_aa = uhf_ccsd_data.lmbda.l1_aa
    l1_bb = uhf_ccsd_data.lmbda.l1_bb
    l2_aaaa = uhf_ccsd_data.lmbda.l2_aaaa
    l2_abab = uhf_ccsd_data.lmbda.l2_abab
    l2_bbbb = uhf_ccsd_data.lmbda.l2_bbbb
    
    lambda_singles_res_aa =  1.00 * einsum('ia->ia', f_aa[oa, va])
    lambda_singles_res_aa +=  1.00 * einsum('jj,ia->ia', f_aa[oa, oa], l1_aa)
    lambda_singles_res_aa +=  1.00 * einsum('jj,ia->ia', f_bb[ob, ob], l1_aa)
    lambda_singles_res_aa += -1.00 * einsum('ij,ja->ia', f_aa[oa, oa], l1_aa)
    lambda_singles_res_aa +=  1.00 * einsum('ba,ib->ia', f_aa[va, va], l1_aa)
    lambda_singles_res_aa += -1.00 * einsum('bj,ijba->ia', f_aa[va, oa], l2_aaaa)
    lambda_singles_res_aa +=  1.00 * einsum('bj,ijab->ia', f_bb[vb, ob], l2_abab)
    lambda_singles_res_aa +=  1.00 * einsum('jb,bj,ia->ia', f_aa[oa, va], t1_aa, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('jb,bj,ia->ia', f_bb[ob, vb], t1_bb, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ib,bj,ja->ia', f_aa[oa, va], t1_aa, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ja,bj,ib->ia', f_aa[oa, va], t1_aa, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kj,bk,ijba->ia', f_aa[oa, oa], t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kj,bk,ijab->ia', f_bb[ob, ob], t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('bc,cj,ijba->ia', f_aa[va, va], t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('bc,cj,ijab->ia', f_bb[vb, vb], t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kc,cbjk,ijba->ia', f_aa[oa, va], t2_aaaa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kc,cbkj,ijab->ia', f_aa[oa, va], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kc,bcjk,ijba->ia', f_bb[ob, vb], t2_abab, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kc,cbjk,ijab->ia', f_bb[ob, vb], t2_bbbb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ic,cbjk,jkba->ia', f_aa[oa, va], t2_aaaa, l2_aaaa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ic,cbjk,jkab->ia', f_aa[oa, va], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ic,cbkj,kjab->ia', f_aa[oa, va], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ka,cbjk,ijcb->ia', f_aa[oa, va], t2_aaaa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ka,cbkj,ijcb->ia', f_aa[oa, va], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ka,bckj,ijbc->ia', f_aa[oa, va], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kc,bk,cj,ijba->ia', f_aa[oa, va], t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kc,bk,cj,ijab->ia', f_bb[ob, vb], t1_bb, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('kjkj,ia->ia', g_aaaa[oa, oa, oa, oa], l1_aa)
    lambda_singles_res_aa += -0.50 * einsum('kjkj,ia->ia', g_abab[oa, ob, oa, ob], l1_aa)
    lambda_singles_res_aa += -0.50 * einsum('jkjk,ia->ia', g_abab[oa, ob, oa, ob], l1_aa)
    lambda_singles_res_aa += -0.50 * einsum('kjkj,ia->ia', g_bbbb[ob, ob, ob, ob], l1_aa)
    lambda_singles_res_aa +=  1.00 * einsum('ibaj,jb->ia', g_aaaa[oa, va, va, oa], l1_aa)
    lambda_singles_res_aa +=  1.00 * einsum('ibaj,jb->ia', g_abab[oa, vb, va, ob], l1_bb)
    lambda_singles_res_aa +=  0.50 * einsum('ibjk,jkba->ia', g_aaaa[oa, va, oa, oa], l2_aaaa)
    lambda_singles_res_aa += -0.50 * einsum('ibjk,jkab->ia', g_abab[oa, vb, oa, ob], l2_abab)
    lambda_singles_res_aa += -0.50 * einsum('ibkj,kjab->ia', g_abab[oa, vb, oa, ob], l2_abab)
    lambda_singles_res_aa +=  0.50 * einsum('cbaj,ijcb->ia', g_aaaa[va, va, va, oa], l2_aaaa)
    lambda_singles_res_aa +=  0.50 * einsum('cbaj,ijcb->ia', g_abab[va, vb, va, ob], l2_abab)
    lambda_singles_res_aa +=  0.50 * einsum('bcaj,ijbc->ia', g_abab[va, vb, va, ob], l2_abab)
    lambda_singles_res_aa += -1.00 * einsum('ijba,bj->ia', g_aaaa[oa, oa, va, va], t1_aa)
    lambda_singles_res_aa +=  1.00 * einsum('ijab,bj->ia', g_abab[oa, ob, va, vb], t1_bb)
    lambda_singles_res_aa +=  1.00 * einsum('ikbj,bk,ja->ia', g_aaaa[oa, oa, va, oa], t1_aa, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ikjb,bk,ja->ia', g_abab[oa, ob, oa, vb], t1_bb, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ikaj,bk,jb->ia', g_aaaa[oa, oa, va, oa], t1_aa, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ikaj,bk,jb->ia', g_abab[oa, ob, va, ob], t1_bb, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('jbca,cj,ib->ia', g_aaaa[oa, va, va, va], t1_aa, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('bjac,cj,ib->ia', g_abab[va, ob, va, vb], t1_bb, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ibca,cj,jb->ia', g_aaaa[oa, va, va, va], t1_aa, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ibac,cj,jb->ia', g_abab[oa, vb, va, vb], t1_bb, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('iljk,bl,jkba->ia', g_aaaa[oa, oa, oa, oa], t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('iljk,bl,jkab->ia', g_abab[oa, ob, oa, ob], t1_bb, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilkj,bl,kjab->ia', g_abab[oa, ob, oa, ob], t1_bb, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kbcj,ck,ijba->ia', g_aaaa[oa, va, va, oa], t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kbcj,ck,ijab->ia', g_abab[oa, vb, va, ob], t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('bkjc,ck,ijba->ia', g_abab[va, ob, oa, vb], t1_bb, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kbcj,ck,ijab->ia', g_bbbb[ob, vb, vb, ob], t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ibck,cj,jkba->ia', g_aaaa[oa, va, va, oa], t1_aa, l2_aaaa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ibck,cj,jkab->ia', g_abab[oa, vb, va, ob], t1_aa, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ibkc,cj,kjab->ia', g_abab[oa, vb, oa, vb], t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kcaj,bk,ijcb->ia', g_aaaa[oa, va, va, oa], t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kcaj,bk,ijbc->ia', g_abab[oa, vb, va, ob], t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ckaj,bk,ijcb->ia', g_abab[va, ob, va, ob], t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('cbda,dj,ijcb->ia', g_aaaa[va, va, va, va], t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('cbad,dj,ijcb->ia', g_abab[va, vb, va, vb], t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('bcad,dj,ijbc->ia', g_abab[va, vb, va, vb], t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('kjbc,bckj,ia->ia', g_aaaa[oa, oa, va, va], t2_aaaa, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('kjbc,bckj,ia->ia', g_abab[oa, ob, va, vb], t2_abab, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('jkbc,bcjk,ia->ia', g_abab[oa, ob, va, vb], t2_abab, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('kjcb,cbkj,ia->ia', g_abab[oa, ob, va, vb], t2_abab, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('jkcb,cbjk,ia->ia', g_abab[oa, ob, va, vb], t2_abab, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('kjbc,bckj,ia->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ikbc,bcjk,ja->ia', g_aaaa[oa, oa, va, va], t2_aaaa, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ikbc,bcjk,ja->ia', g_abab[oa, ob, va, vb], t2_abab, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ikcb,cbjk,ja->ia', g_abab[oa, ob, va, vb], t2_abab, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('kjca,cbkj,ib->ia', g_aaaa[oa, oa, va, va], t2_aaaa, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('kjac,bckj,ib->ia', g_abab[oa, ob, va, vb], t2_abab, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('jkac,bcjk,ib->ia', g_abab[oa, ob, va, vb], t2_abab, l1_aa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ikca,cbjk,jb->ia', g_aaaa[oa, oa, va, va], t2_aaaa, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ikca,cbkj,jb->ia', g_aaaa[oa, oa, va, va], t2_abab, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ikac,bcjk,jb->ia', g_abab[oa, ob, va, vb], t2_abab, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ikac,cbjk,jb->ia', g_abab[oa, ob, va, vb], t2_bbbb, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkcj,cblk,ijba->ia', g_aaaa[oa, oa, va, oa], t2_aaaa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkcj,cblk,ijab->ia', g_abab[oa, ob, va, ob], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('klcj,cbkl,ijab->ia', g_abab[oa, ob, va, ob], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkjc,bclk,ijba->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('kljc,bckl,ijba->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkcj,cblk,ijab->ia', g_bbbb[ob, ob, vb, ob], t2_bbbb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ilck,cbjl,jkba->ia', g_aaaa[oa, oa, va, oa], t2_aaaa, l2_aaaa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ilck,cbjl,jkab->ia', g_abab[oa, ob, va, ob], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ilck,cblj,kjab->ia', g_aaaa[oa, oa, va, oa], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ilkc,bcjl,jkba->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_aaaa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ilkc,cbjl,kjab->ia', g_abab[oa, ob, oa, vb], t2_bbbb, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('lkaj,cblk,ijcb->ia', g_aaaa[oa, oa, va, oa], t2_aaaa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('lkaj,cblk,ijcb->ia', g_abab[oa, ob, va, ob], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('klaj,cbkl,ijcb->ia', g_abab[oa, ob, va, ob], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('lkaj,bclk,ijbc->ia', g_abab[oa, ob, va, ob], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('klaj,bckl,ijbc->ia', g_abab[oa, ob, va, ob], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilak,cbjl,jkcb->ia', g_aaaa[oa, oa, va, oa], t2_aaaa, l2_aaaa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilak,cbjl,jkcb->ia', g_abab[oa, ob, va, ob], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilak,cblj,kjcb->ia', g_aaaa[oa, oa, va, oa], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilak,bcjl,jkbc->ia', g_abab[oa, ob, va, ob], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilak,bclj,kjbc->ia', g_aaaa[oa, oa, va, oa], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilak,cbjl,jkcb->ia', g_abab[oa, ob, va, ob], t2_bbbb, l2_bbbb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('kbcd,cdjk,ijba->ia', g_aaaa[oa, va, va, va], t2_aaaa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('bkcd,cdjk,ijba->ia', g_abab[va, ob, va, vb], t2_abab, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('kbcd,cdkj,ijab->ia', g_abab[oa, vb, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('bkdc,dcjk,ijba->ia', g_abab[va, ob, va, vb], t2_abab, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('kbdc,dckj,ijab->ia', g_abab[oa, vb, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('kbcd,cdjk,ijab->ia', g_bbbb[ob, vb, vb, vb], t2_bbbb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('ibcd,cdjk,jkba->ia', g_aaaa[oa, va, va, va], t2_aaaa, l2_aaaa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.250 * einsum('ibcd,cdjk,jkab->ia', g_abab[oa, vb, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.250 * einsum('ibcd,cdkj,kjab->ia', g_abab[oa, vb, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.250 * einsum('ibdc,dcjk,jkab->ia', g_abab[oa, vb, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.250 * einsum('ibdc,dckj,kjab->ia', g_abab[oa, vb, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kcda,dbjk,ijcb->ia', g_aaaa[oa, va, va, va], t2_aaaa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kcda,dbkj,ijcb->ia', g_aaaa[oa, va, va, va], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ckad,bdjk,ijcb->ia', g_abab[va, ob, va, vb], t2_abab, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kcad,bdkj,ijbc->ia', g_abab[oa, vb, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ckad,dbjk,ijcb->ia', g_abab[va, ob, va, vb], t2_bbbb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('icda,dbjk,jkcb->ia', g_aaaa[oa, va, va, va], t2_aaaa, l2_aaaa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('icda,dbjk,jkcb->ia', g_aaaa[oa, va, va, va], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('icda,dbkj,kjcb->ia', g_aaaa[oa, va, va, va], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('icad,bdjk,jkbc->ia', g_abab[oa, vb, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('icad,bdkj,kjbc->ia', g_abab[oa, vb, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('icad,dbjk,jkcb->ia', g_abab[oa, vb, va, vb], t2_bbbb, l2_bbbb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('lkcd,dbjl,ck,ijba->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkdc,dbjl,ck,ijba->ia', g_abab[oa, ob, va, vb], t2_aaaa, t1_bb, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('lkcd,dblj,ck,ijab->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkdc,dblj,ck,ijab->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('klcd,bdjl,ck,ijba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkcd,bdjl,ck,ijba->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('klcd,dbjl,ck,ijab->ia', g_abab[oa, ob, va, vb], t2_bbbb, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkcd,dbjl,ck,ijab->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilcd,dbjk,cl,jkba->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ildc,dbjk,cl,jkba->ia', g_abab[oa, ob, va, vb], t2_aaaa, t1_bb, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilcd,dbjk,cl,jkab->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ildc,dbjk,cl,jkab->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilcd,dbkj,cl,kjab->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ildc,dbkj,cl,kjab->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkda,cbjl,dk,ijcb->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkad,cbjl,dk,ijcb->ia', g_abab[oa, ob, va, vb], t2_aaaa, t1_bb, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkda,cblj,dk,ijcb->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkad,cblj,dk,ijcb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkda,bclj,dk,ijbc->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkad,bclj,dk,ijbc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkcd,dblk,cj,ijba->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkdc,dblk,cj,ijab->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('kldc,dbkl,cj,ijab->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkcd,bdlk,cj,ijba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('klcd,bdkl,cj,ijba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkcd,dblk,cj,ijab->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ilcd,dbjl,ck,jkba->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ildc,dbjl,ck,jkab->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ilcd,dblj,ck,kjab->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ilcd,bdjl,ck,jkba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_aaaa, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ilcd,dbjl,ck,kjab->ia', g_abab[oa, ob, va, vb], t2_bbbb, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.250 * einsum('lkda,cblk,dj,ijcb->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('lkad,cblk,dj,ijcb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('klad,cbkl,dj,ijcb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('lkad,bclk,dj,ijbc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('klad,bckl,dj,ijbc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilda,cbjl,dk,jkcb->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilad,cbjl,dk,jkcb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilda,cblj,dk,kjcb->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilad,bcjl,dk,jkbc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilda,bclj,dk,kjbc->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilad,cbjl,dk,jkcb->ia', g_abab[oa, ob, va, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkcd,bk,cdjl,ijba->ia', g_aaaa[oa, oa, va, va], t1_aa, t2_aaaa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('klcd,bk,cdjl,ijba->ia', g_abab[oa, ob, va, vb], t1_aa, t2_abab, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('kldc,bk,dcjl,ijba->ia', g_abab[oa, ob, va, vb], t1_aa, t2_abab, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkcd,bk,cdlj,ijab->ia', g_abab[oa, ob, va, vb], t1_bb, t2_abab, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkdc,bk,dclj,ijab->ia', g_abab[oa, ob, va, vb], t1_bb, t2_abab, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkcd,bk,cdjl,ijab->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t2_bbbb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.250 * einsum('ilcd,bl,cdjk,jkba->ia', g_aaaa[oa, oa, va, va], t1_aa, t2_aaaa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('ilcd,bl,cdjk,jkab->ia', g_abab[oa, ob, va, vb], t1_bb, t2_abab, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('ilcd,bl,cdkj,kjab->ia', g_abab[oa, ob, va, vb], t1_bb, t2_abab, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('ildc,bl,dcjk,jkab->ia', g_abab[oa, ob, va, vb], t1_bb, t2_abab, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.250 * einsum('ildc,bl,dckj,kjab->ia', g_abab[oa, ob, va, vb], t1_bb, t2_abab, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkda,dbjl,ck,ijcb->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('lkda,dblj,ck,ijcb->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('klad,bdjl,ck,ijcb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkad,bdlj,ck,ijbc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('klad,dbjl,ck,ijcb->ia', g_abab[oa, ob, va, vb], t2_bbbb, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilda,dbjk,cl,jkcb->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilda,dbjk,cl,jkcb->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilda,dbkj,cl,kjcb->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilad,bdjk,cl,jkbc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilad,bdkj,cl,kjbc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ilad,dbjk,cl,jkcb->ia', g_abab[oa, ob, va, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('kjbc,bj,ck,ia->ia', g_aaaa[oa, oa, va, va], t1_aa, t1_aa, l1_aa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('jkbc,bj,ck,ia->ia', g_abab[oa, ob, va, vb], t1_aa, t1_bb, l1_aa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('kjcb,bj,ck,ia->ia', g_abab[oa, ob, va, vb], t1_bb, t1_aa, l1_aa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('kjbc,bj,ck,ia->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t1_bb, l1_aa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ikbc,bk,cj,ja->ia', g_aaaa[oa, oa, va, va], t1_aa, t1_aa, l1_aa, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ikcb,bk,cj,ja->ia', g_abab[oa, ob, va, vb], t1_bb, t1_aa, l1_aa, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kjca,bk,cj,ib->ia', g_aaaa[oa, oa, va, va], t1_aa, t1_aa, l1_aa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kjac,bk,cj,ib->ia', g_abab[oa, ob, va, vb], t1_aa, t1_bb, l1_aa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ikca,bk,cj,jb->ia', g_aaaa[oa, oa, va, va], t1_aa, t1_aa, l1_aa, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ikac,bk,cj,jb->ia', g_abab[oa, ob, va, vb], t1_bb, t1_bb, l1_bb, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('lkcj,bl,ck,ijba->ia', g_aaaa[oa, oa, va, oa], t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkjc,bl,ck,ijba->ia', g_abab[oa, ob, oa, vb], t1_aa, t1_bb, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('klcj,bl,ck,ijab->ia', g_abab[oa, ob, va, ob], t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkcj,bl,ck,ijab->ia', g_bbbb[ob, ob, vb, ob], t1_bb, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ilck,bl,cj,jkba->ia', g_aaaa[oa, oa, va, oa], t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ilck,bl,cj,jkab->ia', g_abab[oa, ob, va, ob], t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('ilkc,bl,cj,kjab->ia', g_abab[oa, ob, oa, vb], t1_bb, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('lkaj,bl,ck,ijcb->ia', g_aaaa[oa, oa, va, oa], t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkaj,bl,ck,ijbc->ia', g_abab[oa, ob, va, ob], t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('klaj,bl,ck,ijcb->ia', g_abab[oa, ob, va, ob], t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kbcd,ck,dj,ijba->ia', g_aaaa[oa, va, va, va], t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kbcd,ck,dj,ijab->ia', g_abab[oa, vb, va, vb], t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('bkdc,ck,dj,ijba->ia', g_abab[va, ob, va, vb], t1_bb, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('kbcd,ck,dj,ijab->ia', g_bbbb[ob, vb, vb, vb], t1_bb, t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ibcd,ck,dj,jkba->ia', g_aaaa[oa, va, va, va], t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ibcd,ck,dj,kjab->ia', g_abab[oa, vb, va, vb], t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa += -0.50 * einsum('ibdc,ck,dj,jkab->ia', g_abab[oa, vb, va, vb], t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kcda,bk,dj,ijcb->ia', g_aaaa[oa, va, va, va], t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('kcad,bk,dj,ijbc->ia', g_abab[oa, vb, va, vb], t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('ckad,bk,dj,ijcb->ia', g_abab[va, ob, va, vb], t1_bb, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('lkcd,bl,ck,dj,ijba->ia', g_aaaa[oa, oa, va, va], t1_aa, t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 3), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkdc,bl,ck,dj,ijba->ia', g_abab[oa, ob, va, vb], t1_aa, t1_bb, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 2), (0, 3), (0, 2), (0, 1)])
    lambda_singles_res_aa += -1.00 * einsum('klcd,bl,ck,dj,ijab->ia', g_abab[oa, ob, va, vb], t1_bb, t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (1, 3), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  1.00 * einsum('lkcd,bl,ck,dj,ijab->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t1_bb, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (1, 3), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilcd,bl,ck,dj,jkba->ia', g_aaaa[oa, oa, va, va], t1_aa, t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ilcd,bl,ck,dj,kjab->ia', g_abab[oa, ob, va, vb], t1_bb, t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 3), (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('ildc,bl,ck,dj,jkab->ia', g_abab[oa, ob, va, vb], t1_bb, t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkda,bl,ck,dj,ijcb->ia', g_aaaa[oa, oa, va, va], t1_aa, t1_aa, t1_aa, l2_aaaa, optimize=['einsum_path', (0, 1), (0, 3), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('lkad,bl,ck,dj,ijbc->ia', g_abab[oa, ob, va, vb], t1_aa, t1_bb, t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_aa +=  0.50 * einsum('klad,bl,ck,dj,ijcb->ia', g_abab[oa, ob, va, vb], t1_bb, t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1), (0, 1)])
    return lambda_singles_res_aa


def get_lambda_singles_res_bb(
    uhf_scf_data: Intermediates,
    uhf_ccsd_data: UHF_CCSD_Data,
) -> NDArray:
    f_aa = uhf_scf_data.f_aa
    f_bb = uhf_scf_data.f_bb
    g_aaaa = uhf_scf_data.g_aaaa
    g_abab = uhf_scf_data.g_abab
    g_bbbb = uhf_scf_data.g_bbbb
    va = uhf_scf_data.va
    vb = uhf_scf_data.vb
    oa = uhf_scf_data.oa
    ob = uhf_scf_data.ob
    t1_aa = uhf_ccsd_data.t1_aa
    t1_bb = uhf_ccsd_data.t1_bb
    t2_aaaa = uhf_ccsd_data.t2_aaaa
    t2_abab = uhf_ccsd_data.t2_abab
    t2_bbbb = uhf_ccsd_data.t2_bbbb
    if uhf_ccsd_data.lmbda is None:
        raise RuntimeError("Lambda amplitues missing in UHF_CCSD_Data")
    l1_aa = uhf_ccsd_data.lmbda.l1_aa
    l1_bb = uhf_ccsd_data.lmbda.l1_bb
    l2_aaaa = uhf_ccsd_data.lmbda.l2_aaaa
    l2_abab = uhf_ccsd_data.lmbda.l2_abab
    l2_bbbb = uhf_ccsd_data.lmbda.l2_bbbb
    
    lambda_singles_res_bb =  1.00 * einsum('ia->ia', f_bb[ob, vb])
    lambda_singles_res_bb +=  1.00 * einsum('jj,ia->ia', f_aa[oa, oa], l1_bb)
    lambda_singles_res_bb +=  1.00 * einsum('jj,ia->ia', f_bb[ob, ob], l1_bb)
    lambda_singles_res_bb += -1.00 * einsum('ij,ja->ia', f_bb[ob, ob], l1_bb)
    lambda_singles_res_bb +=  1.00 * einsum('ba,ib->ia', f_bb[vb, vb], l1_bb)
    lambda_singles_res_bb +=  1.00 * einsum('bj,jiba->ia', f_aa[va, oa], l2_abab)
    lambda_singles_res_bb += -1.00 * einsum('bj,ijba->ia', f_bb[vb, ob], l2_bbbb)
    lambda_singles_res_bb +=  1.00 * einsum('jb,bj,ia->ia', f_aa[oa, va], t1_aa, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('jb,bj,ia->ia', f_bb[ob, vb], t1_bb, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ib,bj,ja->ia', f_bb[ob, vb], t1_bb, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ja,bj,ib->ia', f_bb[ob, vb], t1_bb, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kj,bk,jiba->ia', f_aa[oa, oa], t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kj,bk,ijba->ia', f_bb[ob, ob], t1_bb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('bc,cj,jiba->ia', f_aa[va, va], t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('bc,cj,ijba->ia', f_bb[vb, vb], t1_bb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kc,cbjk,jiba->ia', f_aa[oa, va], t2_aaaa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kc,cbkj,ijba->ia', f_aa[oa, va], t2_abab, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kc,bcjk,jiba->ia', f_bb[ob, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kc,cbjk,ijba->ia', f_bb[ob, vb], t2_bbbb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ic,bcjk,jkba->ia', f_bb[ob, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ic,bckj,kjba->ia', f_bb[ob, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ic,cbjk,jkba->ia', f_bb[ob, vb], t2_bbbb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ka,cbjk,jicb->ia', f_bb[ob, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ka,bcjk,jibc->ia', f_bb[ob, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ka,cbjk,ijcb->ia', f_bb[ob, vb], t2_bbbb, l2_bbbb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kc,bk,cj,jiba->ia', f_aa[oa, va], t1_aa, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kc,bk,cj,ijba->ia', f_bb[ob, vb], t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kjkj,ia->ia', g_aaaa[oa, oa, oa, oa], l1_bb)
    lambda_singles_res_bb += -0.50 * einsum('kjkj,ia->ia', g_abab[oa, ob, oa, ob], l1_bb)
    lambda_singles_res_bb += -0.50 * einsum('jkjk,ia->ia', g_abab[oa, ob, oa, ob], l1_bb)
    lambda_singles_res_bb += -0.50 * einsum('kjkj,ia->ia', g_bbbb[ob, ob, ob, ob], l1_bb)
    lambda_singles_res_bb +=  1.00 * einsum('bija,jb->ia', g_abab[va, ob, oa, vb], l1_aa)
    lambda_singles_res_bb +=  1.00 * einsum('ibaj,jb->ia', g_bbbb[ob, vb, vb, ob], l1_bb)
    lambda_singles_res_bb += -0.50 * einsum('bijk,jkba->ia', g_abab[va, ob, oa, ob], l2_abab)
    lambda_singles_res_bb += -0.50 * einsum('bikj,kjba->ia', g_abab[va, ob, oa, ob], l2_abab)
    lambda_singles_res_bb +=  0.50 * einsum('ibjk,jkba->ia', g_bbbb[ob, vb, ob, ob], l2_bbbb)
    lambda_singles_res_bb +=  0.50 * einsum('cbja,jicb->ia', g_abab[va, vb, oa, vb], l2_abab)
    lambda_singles_res_bb +=  0.50 * einsum('bcja,jibc->ia', g_abab[va, vb, oa, vb], l2_abab)
    lambda_singles_res_bb +=  0.50 * einsum('cbaj,ijcb->ia', g_bbbb[vb, vb, vb, ob], l2_bbbb)
    lambda_singles_res_bb +=  1.00 * einsum('jiba,bj->ia', g_abab[oa, ob, va, vb], t1_aa)
    lambda_singles_res_bb += -1.00 * einsum('ijba,bj->ia', g_bbbb[ob, ob, vb, vb], t1_bb)
    lambda_singles_res_bb += -1.00 * einsum('kibj,bk,ja->ia', g_abab[oa, ob, va, ob], t1_aa, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('ikbj,bk,ja->ia', g_bbbb[ob, ob, vb, ob], t1_bb, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kija,bk,jb->ia', g_abab[oa, ob, oa, vb], t1_aa, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ikaj,bk,jb->ia', g_bbbb[ob, ob, vb, ob], t1_bb, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('jbca,cj,ib->ia', g_abab[oa, vb, va, vb], t1_aa, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('jbca,cj,ib->ia', g_bbbb[ob, vb, vb, vb], t1_bb, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('bica,cj,jb->ia', g_abab[va, ob, va, vb], t1_aa, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ibca,cj,jb->ia', g_bbbb[ob, vb, vb, vb], t1_bb, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lijk,bl,jkba->ia', g_abab[oa, ob, oa, ob], t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('likj,bl,kjba->ia', g_abab[oa, ob, oa, ob], t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('iljk,bl,jkba->ia', g_bbbb[ob, ob, ob, ob], t1_bb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kbcj,ck,jiba->ia', g_aaaa[oa, va, va, oa], t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kbcj,ck,ijba->ia', g_abab[oa, vb, va, ob], t1_aa, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('bkjc,ck,jiba->ia', g_abab[va, ob, oa, vb], t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kbcj,ck,ijba->ia', g_bbbb[ob, vb, vb, ob], t1_bb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('bick,cj,jkba->ia', g_abab[va, ob, va, ob], t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('bikc,cj,kjba->ia', g_abab[va, ob, oa, vb], t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('ibck,cj,jkba->ia', g_bbbb[ob, vb, vb, ob], t1_bb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kcja,bk,jibc->ia', g_abab[oa, vb, oa, vb], t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ckja,bk,jicb->ia', g_abab[va, ob, oa, vb], t1_bb, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kcaj,bk,ijcb->ia', g_bbbb[ob, vb, vb, ob], t1_bb, l2_bbbb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('cbda,dj,jicb->ia', g_abab[va, vb, va, vb], t1_aa, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('bcda,dj,jibc->ia', g_abab[va, vb, va, vb], t1_aa, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('cbda,dj,ijcb->ia', g_bbbb[vb, vb, vb, vb], t1_bb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('kjbc,bckj,ia->ia', g_aaaa[oa, oa, va, va], t2_aaaa, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('kjbc,bckj,ia->ia', g_abab[oa, ob, va, vb], t2_abab, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('jkbc,bcjk,ia->ia', g_abab[oa, ob, va, vb], t2_abab, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('kjcb,cbkj,ia->ia', g_abab[oa, ob, va, vb], t2_abab, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('jkcb,cbjk,ia->ia', g_abab[oa, ob, va, vb], t2_abab, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('kjbc,bckj,ia->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kibc,bckj,ja->ia', g_abab[oa, ob, va, vb], t2_abab, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kicb,cbkj,ja->ia', g_abab[oa, ob, va, vb], t2_abab, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ikbc,bcjk,ja->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, l1_bb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kjca,cbkj,ib->ia', g_abab[oa, ob, va, vb], t2_abab, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('jkca,cbjk,ib->ia', g_abab[oa, ob, va, vb], t2_abab, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kjca,cbkj,ib->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kica,cbjk,jb->ia', g_abab[oa, ob, va, vb], t2_aaaa, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kica,cbkj,jb->ia', g_abab[oa, ob, va, vb], t2_abab, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ikca,bcjk,jb->ia', g_bbbb[ob, ob, vb, vb], t2_abab, l1_aa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('ikca,cbjk,jb->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, l1_bb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lkcj,cblk,jiba->ia', g_aaaa[oa, oa, va, oa], t2_aaaa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkcj,cblk,ijba->ia', g_abab[oa, ob, va, ob], t2_abab, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('klcj,cbkl,ijba->ia', g_abab[oa, ob, va, ob], t2_abab, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lkjc,bclk,jiba->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kljc,bckl,jiba->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkcj,cblk,ijba->ia', g_bbbb[ob, ob, vb, ob], t2_bbbb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('lick,cbjl,jkba->ia', g_abab[oa, ob, va, ob], t2_aaaa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lick,cblj,jkba->ia', g_abab[oa, ob, va, ob], t2_abab, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('ilck,bcjl,jkba->ia', g_bbbb[ob, ob, vb, ob], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('likc,bclj,kjba->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ilck,cbjl,jkba->ia', g_bbbb[ob, ob, vb, ob], t2_bbbb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('lkja,cblk,jicb->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('klja,cbkl,jicb->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('lkja,bclk,jibc->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('klja,bckl,jibc->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('lkaj,cblk,ijcb->ia', g_bbbb[ob, ob, vb, ob], t2_bbbb, l2_bbbb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lika,cbjl,jkcb->ia', g_abab[oa, ob, oa, vb], t2_aaaa, l2_aaaa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ilak,cbjl,jkcb->ia', g_bbbb[ob, ob, vb, ob], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lika,cblj,kjcb->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ilak,bcjl,jkbc->ia', g_bbbb[ob, ob, vb, ob], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lika,bclj,kjbc->ia', g_abab[oa, ob, oa, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ilak,cbjl,jkcb->ia', g_bbbb[ob, ob, vb, ob], t2_bbbb, l2_bbbb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kbcd,cdjk,jiba->ia', g_aaaa[oa, va, va, va], t2_aaaa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('bkcd,cdjk,jiba->ia', g_abab[va, ob, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kbcd,cdkj,ijba->ia', g_abab[oa, vb, va, vb], t2_abab, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('bkdc,dcjk,jiba->ia', g_abab[va, ob, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kbdc,dckj,ijba->ia', g_abab[oa, vb, va, vb], t2_abab, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('kbcd,cdjk,ijba->ia', g_bbbb[ob, vb, vb, vb], t2_bbbb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.250 * einsum('bicd,cdjk,jkba->ia', g_abab[va, ob, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.250 * einsum('bicd,cdkj,kjba->ia', g_abab[va, ob, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.250 * einsum('bidc,dcjk,jkba->ia', g_abab[va, ob, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.250 * einsum('bidc,dckj,kjba->ia', g_abab[va, ob, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('ibcd,cdjk,jkba->ia', g_bbbb[ob, vb, vb, vb], t2_bbbb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kcda,dbjk,jibc->ia', g_abab[oa, vb, va, vb], t2_aaaa, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ckda,dbjk,jicb->ia', g_abab[va, ob, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kcda,dbkj,ijcb->ia', g_abab[oa, vb, va, vb], t2_abab, l2_bbbb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kcda,bdjk,jibc->ia', g_bbbb[ob, vb, vb, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kcda,dbjk,ijcb->ia', g_bbbb[ob, vb, vb, vb], t2_bbbb, l2_bbbb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('cida,dbjk,jkcb->ia', g_abab[va, ob, va, vb], t2_aaaa, l2_aaaa, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('cida,dbjk,jkcb->ia', g_abab[va, ob, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('cida,dbkj,kjcb->ia', g_abab[va, ob, va, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('icda,bdjk,jkbc->ia', g_bbbb[ob, vb, vb, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('icda,bdkj,kjbc->ia', g_bbbb[ob, vb, vb, vb], t2_abab, l2_abab, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('icda,dbjk,jkcb->ia', g_bbbb[ob, vb, vb, vb], t2_bbbb, l2_bbbb, optimize=['einsum_path', (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('lkcd,dbjl,ck,jiba->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkdc,dbjl,ck,jiba->ia', g_abab[oa, ob, va, vb], t2_aaaa, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('lkcd,dblj,ck,ijba->ia', g_aaaa[oa, oa, va, va], t2_abab, t1_aa, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkdc,dblj,ck,ijba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('klcd,bdjl,ck,jiba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkcd,bdjl,ck,jiba->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('klcd,dbjl,ck,ijba->ia', g_abab[oa, ob, va, vb], t2_bbbb, t1_aa, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkcd,dbjl,ck,ijba->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('licd,bdjk,cl,jkba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ilcd,bdjk,cl,jkba->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('licd,bdkj,cl,kjba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ilcd,bdkj,cl,kjba->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('licd,dbjk,cl,jkba->ia', g_abab[oa, ob, va, vb], t2_bbbb, t1_aa, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ilcd,dbjk,cl,jkba->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('klda,cbjl,dk,jicb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkda,cbjl,dk,jicb->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('klda,bcjl,dk,jibc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkda,bcjl,dk,jibc->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('klda,cbjl,dk,ijcb->ia', g_abab[oa, ob, va, vb], t2_bbbb, t1_aa, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lkda,cbjl,dk,ijcb->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkcd,dblk,cj,jiba->ia', g_aaaa[oa, oa, va, va], t2_aaaa, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkdc,dblk,cj,ijba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('kldc,dbkl,cj,ijba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lkcd,bdlk,cj,jiba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('klcd,bdkl,cj,jiba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lkcd,dblk,cj,ijba->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('lidc,dbjl,ck,jkba->ia', g_abab[oa, ob, va, vb], t2_aaaa, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lidc,dblj,ck,jkba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ilcd,bdjl,ck,jkba->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('licd,bdlj,ck,kjba->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('ilcd,dbjl,ck,jkba->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('lkda,cblk,dj,jicb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('klda,cbkl,dj,jicb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('lkda,bclk,dj,jibc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('klda,bckl,dj,jibc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.250 * einsum('lkda,cblk,dj,ijcb->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lida,cbjl,dk,jkcb->ia', g_abab[oa, ob, va, vb], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ilda,cbjl,dk,jkcb->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lida,cblj,dk,kjcb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ilda,bcjl,dk,jkbc->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lida,bclj,dk,kjbc->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ilda,cbjl,dk,jkcb->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkcd,bk,cdjl,jiba->ia', g_aaaa[oa, oa, va, va], t1_aa, t2_aaaa, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('klcd,bk,cdjl,jiba->ia', g_abab[oa, ob, va, vb], t1_aa, t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kldc,bk,dcjl,jiba->ia', g_abab[oa, ob, va, vb], t1_aa, t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkcd,bk,cdlj,ijba->ia', g_abab[oa, ob, va, vb], t1_bb, t2_abab, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkdc,bk,dclj,ijba->ia', g_abab[oa, ob, va, vb], t1_bb, t2_abab, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lkcd,bk,cdjl,ijba->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t2_bbbb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('licd,bl,cdjk,jkba->ia', g_abab[oa, ob, va, vb], t1_aa, t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('licd,bl,cdkj,kjba->ia', g_abab[oa, ob, va, vb], t1_aa, t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('lidc,bl,dcjk,jkba->ia', g_abab[oa, ob, va, vb], t1_aa, t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.250 * einsum('lidc,bl,dckj,kjba->ia', g_abab[oa, ob, va, vb], t1_aa, t2_abab, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.250 * einsum('ilcd,bl,cdjk,jkba->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t2_bbbb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('lkda,dbjl,ck,jibc->ia', g_abab[oa, ob, va, vb], t2_aaaa, t1_bb, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('klda,dbjl,ck,jicb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkda,dblj,ck,ijcb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_bb, l2_bbbb, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkda,bdjl,ck,jibc->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('lkda,dbjl,ck,ijcb->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lida,dbjk,cl,jkcb->ia', g_abab[oa, ob, va, vb], t2_aaaa, t1_aa, l2_aaaa, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lida,dbjk,cl,jkcb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lida,dbkj,cl,kjcb->ia', g_abab[oa, ob, va, vb], t2_abab, t1_aa, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ilda,bdjk,cl,jkbc->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ilda,bdkj,cl,kjbc->ia', g_bbbb[ob, ob, vb, vb], t2_abab, t1_bb, l2_abab, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ilda,dbjk,cl,jkcb->ia', g_bbbb[ob, ob, vb, vb], t2_bbbb, t1_bb, l2_bbbb, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kjbc,bj,ck,ia->ia', g_aaaa[oa, oa, va, va], t1_aa, t1_aa, l1_bb, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('jkbc,bj,ck,ia->ia', g_abab[oa, ob, va, vb], t1_aa, t1_bb, l1_bb, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('kjcb,bj,ck,ia->ia', g_abab[oa, ob, va, vb], t1_bb, t1_aa, l1_bb, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('kjbc,bj,ck,ia->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t1_bb, l1_bb, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kibc,bk,cj,ja->ia', g_abab[oa, ob, va, vb], t1_aa, t1_bb, l1_bb, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('ikbc,bk,cj,ja->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t1_bb, l1_bb, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('jkca,bk,cj,ib->ia', g_abab[oa, ob, va, vb], t1_bb, t1_aa, l1_bb, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kjca,bk,cj,ib->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t1_bb, l1_bb, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kica,bk,cj,jb->ia', g_abab[oa, ob, va, vb], t1_aa, t1_aa, l1_aa, optimize=['einsum_path', (2, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('ikca,bk,cj,jb->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t1_bb, l1_bb, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('lkcj,bl,ck,jiba->ia', g_aaaa[oa, oa, va, oa], t1_aa, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkjc,bl,ck,jiba->ia', g_abab[oa, ob, oa, vb], t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('klcj,bl,ck,ijba->ia', g_abab[oa, ob, va, ob], t1_bb, t1_aa, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkcj,bl,ck,ijba->ia', g_bbbb[ob, ob, vb, ob], t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('lick,bl,cj,jkba->ia', g_abab[oa, ob, va, ob], t1_aa, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('likc,bl,cj,kjba->ia', g_abab[oa, ob, oa, vb], t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ilck,bl,cj,jkba->ia', g_bbbb[ob, ob, vb, ob], t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkja,bl,ck,jibc->ia', g_abab[oa, ob, oa, vb], t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('klja,bl,ck,jicb->ia', g_abab[oa, ob, oa, vb], t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('lkaj,bl,ck,ijcb->ia', g_bbbb[ob, ob, vb, ob], t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('kbcd,ck,dj,jiba->ia', g_aaaa[oa, va, va, va], t1_aa, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kbcd,ck,dj,ijba->ia', g_abab[oa, vb, va, vb], t1_aa, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('bkdc,ck,dj,jiba->ia', g_abab[va, ob, va, vb], t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kbcd,ck,dj,ijba->ia', g_bbbb[ob, vb, vb, vb], t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('bicd,ck,dj,kjba->ia', g_abab[va, ob, va, vb], t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('bidc,ck,dj,jkba->ia', g_abab[va, ob, va, vb], t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_bb += -0.50 * einsum('ibcd,ck,dj,jkba->ia', g_bbbb[ob, vb, vb, vb], t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 1), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kcda,bk,dj,jibc->ia', g_abab[oa, vb, va, vb], t1_aa, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 1), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('ckda,bk,dj,jicb->ia', g_abab[va, ob, va, vb], t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (1, 3), (1, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('kcda,bk,dj,ijcb->ia', g_bbbb[ob, vb, vb, vb], t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('lkcd,bl,ck,dj,jiba->ia', g_aaaa[oa, oa, va, va], t1_aa, t1_aa, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 3), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkdc,bl,ck,dj,jiba->ia', g_abab[oa, ob, va, vb], t1_aa, t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 3), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  1.00 * einsum('klcd,bl,ck,dj,ijba->ia', g_abab[oa, ob, va, vb], t1_bb, t1_aa, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (1, 3), (0, 2), (0, 1)])
    lambda_singles_res_bb += -1.00 * einsum('lkcd,bl,ck,dj,ijba->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (1, 3), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('licd,bl,ck,dj,kjba->ia', g_abab[oa, ob, va, vb], t1_aa, t1_aa, t1_bb, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lidc,bl,ck,dj,jkba->ia', g_abab[oa, ob, va, vb], t1_aa, t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 3), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('ilcd,bl,ck,dj,jkba->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 2), (0, 2), (0, 1), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkda,bl,ck,dj,jibc->ia', g_abab[oa, ob, va, vb], t1_aa, t1_bb, t1_aa, l2_abab, optimize=['einsum_path', (0, 1), (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('klda,bl,ck,dj,jicb->ia', g_abab[oa, ob, va, vb], t1_bb, t1_aa, t1_aa, l2_abab, optimize=['einsum_path', (0, 2), (0, 2), (0, 2), (0, 1)])
    lambda_singles_res_bb +=  0.50 * einsum('lkda,bl,ck,dj,ijcb->ia', g_bbbb[ob, ob, vb, vb], t1_bb, t1_bb, t1_bb, l2_bbbb, optimize=['einsum_path', (0, 3), (0, 2), (0, 2), (0, 1)])
    return lambda_singles_res_bb
